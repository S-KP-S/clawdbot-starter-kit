# 2026-01-25 - Saturday

## Vapi/Quinn Fixes

### Problem: Calendar booking wrong dates
- Quinn (GPT-4o Mini) was hallucinating dates - booked "Saturday 4pm" as November 4, 2023 instead of Jan 31, 2026
- Root cause: Model didn't know current date

### Solution: Vapi Dynamic Variables
Added to Quinn's system prompt:
```
Today is {{"now" | date: "%A, %B %d, %Y", "America/Chicago"}}.
Current time: {{"now" | date: "%I:%M %p", "America/Chicago"}}.
Year: {{year}}.
```
Vapi auto-fills these at runtime. Docs: https://docs.vapi.ai/assistants/dynamic-variables

### Contacts Knowledge Base
- Created `contacts.md` with phone→name mappings
- Uploaded to Vapi (file ID: `d9eb086e-c5b6-458d-989c-3b1002dc531b`)
- Added to Quinn's knowledge base tool
- Quinn now searches KB to identify callers by phone number

### Ahsan's Contact
- Phone: +14166066891
- Email: eslamiahsan@gmail.com
- Note: Spencer initially heard "Hassan" but it's Ahsan

### Learnings
- Always inject current date into LLM prompts for scheduling tasks
- Vapi supports LiquidJS date formatting with timezones
- `{{customer.number}}` gives caller ID in prompts
- Upload contacts as knowledge base file, not hardcoded in prompt

## Outbound Calling Improvements

### Problem: Quinn failed restaurant reservation calls
1. **Valter's Osteria** - silence timeout (no answer)
2. **Caffé Molise** - hit voicemail, tried DTMF instead of speaking, got stuck in IVR

### Solution: Improved outbound prompt
Key rules added:
1. **Voicemail detection** - recognize "leave your name, phone, date" → speak message
2. **DTMF discipline** - ONLY press buttons when explicitly told "press X for Y"
3. **Speak don't press** - when asked for info, speak it verbally
4. **IVR escape** - say "operator" if stuck in loop
5. **Loop detection** - end call after 2 "incorrect" errors

### Result
Second attempt worked - Quinn recognized voicemail, left proper message, ended gracefully.
Template saved to `tmp/outbound-reservation-prompt.md`
